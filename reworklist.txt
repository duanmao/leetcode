#94 non-recursive version
#22
#347
